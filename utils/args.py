from argparse import ArgumentParser
from datasets import NAMES as DATASET_NAMES
from models import get_all_models


def add_experiment_args(parser: ArgumentParser) -> None:
    """
    Adds the arguments used by all the models.
    :param parser: the parser instance
    """
    parser.add_argument(
        "--dataset",
        type=str,
        required=True,
        choices=DATASET_NAMES,
        help="Which dataset to perform experiments on.",
    )
    parser.add_argument(
        "--model", type=str, required=True, help="Model name.", choices=get_all_models()
    )

    parser.add_argument("--lr", type=float, required=True, help="Learning rate.")
    parser.add_argument("--batch_size", type=int, required=True, help="Batch size.")
    parser.add_argument(
        "--n_epochs",
        type=int,
        required=True,
        help="The number of epochs for each task.",
    )


def add_management_args(parser: ArgumentParser) -> None:
    parser.add_argument("--seed", type=int, default=None, help="The random seed.")
    parser.add_argument("--notes", type=str, default=None, help="Notes for this run.")

    parser.add_argument("--csv_log", action="store_true", help="Enable csv logging")
    parser.add_argument(
        "--tensorboard", action="store_true", help="Enable tensorboard logging"
    )
    parser.add_argument(
        "--validation", action="store_true", help="Test on the validation set"
    )
    parser.add_argument("--GAN", action="store_true", help="Enable GAN augment")


def add_rehearsal_args(parser: ArgumentParser) -> None:
    """
    Adds the arguments used by all the rehearsal-based methods
    :param parser: the parser instance
    """
    parser.add_argument(
        "--buffer_size", type=int, required=True, help="The size of the memory buffer."
    )
    parser.add_argument(
        "--minibatch_size",
        type=int,
        required=True,
        help="The batch size of the memory buffer.",
    )
